{"version":3,"file":"use-visual-state.mjs.js","sources":["../../../../../../../../node_modules/framer-motion/dist/es/motion/utils/use-visual-state.mjs"],"sourcesContent":["import { __rest } from 'tslib';\nimport { useContext } from 'react';\nimport { isAnimationControls } from '../../animation/utils/is-animation-controls.mjs';\nimport { PresenceContext } from '../../context/PresenceContext.mjs';\nimport { checkIfControllingVariants, checkIfVariantNode, resolveVariantFromProps } from '../../render/utils/variants.mjs';\nimport { useConstant } from '../../utils/use-constant.mjs';\nimport { resolveMotionValue } from '../../value/utils/resolve-motion-value.mjs';\nimport { MotionContext } from '../../context/MotionContext/index.mjs';\n\nfunction makeState(_a, props, context, presenceContext) {\n    var scrapeMotionValuesFromProps = _a.scrapeMotionValuesFromProps, createRenderState = _a.createRenderState, onMount = _a.onMount;\n    var state = {\n        latestValues: makeLatestValues(props, context, presenceContext, scrapeMotionValuesFromProps),\n        renderState: createRenderState(),\n    };\n    if (onMount) {\n        state.mount = function (instance) { return onMount(props, instance, state); };\n    }\n    return state;\n}\nvar makeUseVisualState = function (config) {\n    return function (props, isStatic) {\n        var context = useContext(MotionContext);\n        var presenceContext = useContext(PresenceContext);\n        return isStatic\n            ? makeState(config, props, context, presenceContext)\n            : useConstant(function () {\n                return makeState(config, props, context, presenceContext);\n            });\n    };\n};\nfunction makeLatestValues(props, context, presenceContext, scrapeMotionValues) {\n    var values = {};\n    var blockInitialAnimation = (presenceContext === null || presenceContext === void 0 ? void 0 : presenceContext.initial) === false;\n    var motionValues = scrapeMotionValues(props);\n    for (var key in motionValues) {\n        values[key] = resolveMotionValue(motionValues[key]);\n    }\n    var initial = props.initial, animate = props.animate;\n    var isControllingVariants = checkIfControllingVariants(props);\n    var isVariantNode = checkIfVariantNode(props);\n    if (context &&\n        isVariantNode &&\n        !isControllingVariants &&\n        props.inherit !== false) {\n        initial !== null && initial !== void 0 ? initial : (initial = context.initial);\n        animate !== null && animate !== void 0 ? animate : (animate = context.animate);\n    }\n    var initialAnimationIsBlocked = blockInitialAnimation || initial === false;\n    var variantToSet = initialAnimationIsBlocked ? animate : initial;\n    if (variantToSet &&\n        typeof variantToSet !== \"boolean\" &&\n        !isAnimationControls(variantToSet)) {\n        var list = Array.isArray(variantToSet) ? variantToSet : [variantToSet];\n        list.forEach(function (definition) {\n            var resolved = resolveVariantFromProps(props, definition);\n            if (!resolved)\n                return;\n            var transitionEnd = resolved.transitionEnd; resolved.transition; var target = __rest(resolved, [\"transitionEnd\", \"transition\"]);\n            for (var key in target) {\n                var valueTarget = target[key];\n                if (Array.isArray(valueTarget)) {\n                    /**\n                     * Take final keyframe if the initial animation is blocked because\n                     * we want to initialise at the end of that blocked animation.\n                     */\n                    var index = initialAnimationIsBlocked\n                        ? valueTarget.length - 1\n                        : 0;\n                    valueTarget = valueTarget[index];\n                }\n                if (valueTarget !== null) {\n                    values[key] = valueTarget;\n                }\n            }\n            for (var key in transitionEnd)\n                values[key] = transitionEnd[key];\n        });\n    }\n    return values;\n}\n\nexport { makeUseVisualState };\n"],"names":[],"mappings":"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"}